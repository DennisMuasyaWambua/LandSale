openapi: 3.0.3
info:
  title: Land Sale API
  version: 1.0.0
  description: Land Sale Management System API
paths:
  /auth/admin/create-admin/:
    post:
      operationId: auth_admin_create_admin_create
      description: Create a new admin user (superuser). Only accessible by existing
        superusers.
      summary: Create Admin User
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  description: Username for the admin user
                email:
                  type: string
                  format: email
                  description: Email address
                password:
                  type: string
                  description: Password for the admin user
                first_name:
                  type: string
                  description: First name (optional)
                last_name:
                  type: string
                  description: Last name (optional)
              required:
              - username
              - email
              - password
      security:
      - jwtAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      username:
                        type: string
                      email:
                        type: string
                      is_staff:
                        type: boolean
                      is_superuser:
                        type: boolean
          description: ''
  /auth/admin/subscription-plans/:
    post:
      operationId: auth_admin_subscription_plans_create
      description: Create a new subscription plan (Admin only)
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubscriptionPlanRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/SubscriptionPlanRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/SubscriptionPlanRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionPlan'
          description: ''
  /auth/admin/subscription-plans/{plan_id}/:
    put:
      operationId: auth_admin_subscription_plans_update
      description: Update a subscription plan (Admin only)
      parameters:
      - in: path
        name: plan_id
        schema:
          type: integer
        required: true
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubscriptionPlanRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/SubscriptionPlanRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/SubscriptionPlanRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionPlan'
          description: ''
    patch:
      operationId: auth_admin_subscription_plans_partial_update
      description: Update a subscription plan (Admin only)
      parameters:
      - in: path
        name: plan_id
        schema:
          type: integer
        required: true
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSubscriptionPlanRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedSubscriptionPlanRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedSubscriptionPlanRequest'
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionPlan'
          description: ''
  /auth/admin/subscription-plans/{plan_id}/delete/:
    delete:
      operationId: auth_admin_subscription_plans_delete_destroy
      description: Delete a subscription plan (Admin only)
      parameters:
      - in: path
        name: plan_id
        schema:
          type: integer
        required: true
      tags:
      - auth
      security:
      - jwtAuth: []
      responses:
        '204':
          description: No response body
  /auth/admin/subscription-plans/list/:
    get:
      operationId: auth_admin_subscription_plans_list_list
      description: List all subscription plans (Admin only)
      tags:
      - auth
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SubscriptionPlan'
          description: ''
  /auth/forgot-password/:
    post:
      operationId: auth_forgot_password_create
      description: Send password reset email to user
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ForgotPasswordRequest'
            examples:
              ForgotPasswordExample:
                value:
                  email: john@example.com
                summary: Forgot Password Example
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/ForgotPasswordRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ForgotPasswordRequest'
        required: true
      security:
      - jwtAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              examples:
                ForgotPasswordExample:
                  value:
                    email: john@example.com
                  summary: Forgot Password Example
          description: ''
  /auth/login/:
    post:
      operationId: auth_login_create
      description: Login user with email and get JWT tokens with role information
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLoginRequest'
            examples:
              UserLoginExample:
                value:
                  email: john@example.com
                  password: secure_password123
                summary: User Login Example
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/UserLoginRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/UserLoginRequest'
        required: true
      security:
      - jwtAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Login successful
                  user:
                    type: object
                    description: User details including role
                    properties:
                      id:
                        type: integer
                      username:
                        type: string
                      email:
                        type: string
                      first_name:
                        type: string
                      last_name:
                        type: string
                      is_active:
                        type: boolean
                      date_joined:
                        type: string
                        format: date-time
                      role:
                        type: string
                        enum:
                        - admin
                        - staff
                        - user
                        description: User role based on permissions
                  access:
                    type: string
                    description: JWT access token
                  refresh:
                    type: string
                    description: JWT refresh token
              examples:
                UserLoginExample:
                  value:
                    email: john@example.com
                    password: secure_password123
                  summary: User Login Example
          description: ''
  /auth/my-subscription/:
    get:
      operationId: auth_my_subscription_retrieve
      description: Get current user's subscription status
      tags:
      - auth
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSubscription'
          description: ''
  /auth/payment/history/:
    get:
      operationId: auth_payment_history_list
      description: Get current user's payment history
      tags:
      - auth
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Payment'
          description: ''
  /auth/payment/verify/{order_tracking_id}/:
    get:
      operationId: auth_payment_verify_retrieve
      description: Verify payment status with Pesapal
      parameters:
      - in: path
        name: order_tracking_id
        schema:
          type: string
        required: true
      tags:
      - auth
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
          description: ''
  /auth/profile/:
    get:
      operationId: auth_profile_retrieve
      description: Get current user profile information
      tags:
      - auth
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
  /auth/refresh/:
    post:
      operationId: auth_refresh_create
      description: |-
        Takes a refresh type JSON web token and returns an access type JSON web
        token if the refresh token is valid.
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TokenRefreshRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/TokenRefreshRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/TokenRefreshRequest'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenRefresh'
          description: ''
  /auth/register/:
    post:
      operationId: auth_register_create
      description: Register a new user account
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRegistrationRequest'
            examples:
              UserRegistrationExample:
                value:
                  username: john_doe
                  email: john@example.com
                  first_name: John
                  last_name: Doe
                  password: secure_password123
                  password_confirm: secure_password123
                summary: User Registration Example
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/UserRegistrationRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/UserRegistrationRequest'
        required: true
      security:
      - jwtAuth: []
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: User created successfully
                  user:
                    type: object
                    description: User details including role
                    properties:
                      id:
                        type: integer
                      username:
                        type: string
                      email:
                        type: string
                      first_name:
                        type: string
                      last_name:
                        type: string
                      is_active:
                        type: boolean
                      date_joined:
                        type: string
                        format: date-time
                      role:
                        type: string
                        enum:
                        - admin
                        - staff
                        - user
                        description: User role based on permissions
                  access:
                    type: string
                    description: JWT access token
                  refresh:
                    type: string
                    description: JWT refresh token
              examples:
                UserRegistrationExample:
                  value:
                    username: john_doe
                    email: john@example.com
                    first_name: John
                    last_name: Doe
                    password: secure_password123
                    password_confirm: secure_password123
                  summary: User Registration Example
          description: ''
  /auth/reset-password/:
    post:
      operationId: auth_reset_password_create
      description: Reset user password using token
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ResetPasswordRequest'
            examples:
              ResetPasswordExample:
                value:
                  token: 123e4567-e89b-12d3-a456-426614174000
                  password: new_secure_password123
                  password_confirm: new_secure_password123
                summary: Reset Password Example
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/ResetPasswordRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ResetPasswordRequest'
        required: true
      security:
      - jwtAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              examples:
                ResetPasswordExample:
                  value:
                    token: 123e4567-e89b-12d3-a456-426614174000
                    password: new_secure_password123
                    password_confirm: new_secure_password123
                  summary: Reset Password Example
          description: ''
  /auth/send-email/:
    post:
      operationId: auth_send_email_create
      description: Send an email with optional CC, BCC, and file attachments. Supports
        multiple recipients and multiple file uploads.
      summary: Send Email
      tags:
      - auth
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                subject:
                  type: string
                  description: Email subject line
                  example: Important Update
                body:
                  type: string
                  description: Email body content (can be HTML or plain text)
                  example: Dear valued customer, this is an important update...
                to:
                  type: array
                  items:
                    type: string
                    format: email
                  description: List of recipient email addresses
                  example:
                  - user1@example.com
                  - user2@example.com
                cc:
                  type: array
                  items:
                    type: string
                    format: email
                  description: List of CC email addresses (optional)
                  example:
                  - manager@example.com
                bcc:
                  type: array
                  items:
                    type: string
                    format: email
                  description: List of BCC email addresses (optional)
                  example:
                  - archive@example.com
                attachments:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: File attachments (optional, multiple files supported)
              required:
              - subject
              - body
              - to
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  recipients:
                    type: object
                    properties:
                      to:
                        type: array
                        items:
                          type: string
                      cc:
                        type: array
                        items:
                          type: string
                      bcc:
                        type: array
                        items:
                          type: string
                      total:
                        type: integer
                  attachments_count:
                    type: integer
          description: ''
  /auth/subscribe/:
    post:
      operationId: auth_subscribe_create
      description: Initialize subscription payment with Pesapal
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubscribeRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/SubscribeRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/SubscribeRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
          description: ''
  /auth/subscription-plans/:
    get:
      operationId: auth_subscription_plans_list
      description: List all active subscription plans
      tags:
      - auth
      security:
      - jwtAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SubscriptionPlan'
          description: ''
  /auth/subscription-plans/{plan_id}/:
    get:
      operationId: auth_subscription_plans_retrieve
      description: Get details of a specific subscription plan
      parameters:
      - in: path
        name: plan_id
        schema:
          type: integer
        required: true
      tags:
      - auth
      security:
      - jwtAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionPlan'
          description: ''
  /auth/subscription/cancel/:
    post:
      operationId: auth_subscription_cancel_create
      description: Cancel current user's subscription
      tags:
      - auth
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
          description: ''
  /auth/webhook/pesapal/:
    get:
      operationId: auth_webhook_pesapal_retrieve
      description: Pesapal IPN webhook for payment notifications
      tags:
      - auth
      security:
      - jwtAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
          description: ''
  /dashboard/bookings/:
    get:
      operationId: dashboard_bookings_retrieve
      description: Get all bookings for dashboard management
      summary: Dashboard Bookings
      tags:
      - dashboard
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Booking'
          description: ''
  /dashboard/bookings/{booking_id}/:
    get:
      operationId: dashboard_bookings_retrieve_2
      description: Get booking details by booking ID including balance calculation
      summary: Get Single Booking
      parameters:
      - in: path
        name: booking_id
        schema:
          type: integer
        required: true
      tags:
      - dashboard
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Booking'
          description: ''
  /dashboard/payinstallment/:
    post:
      operationId: dashboard_payinstallment_create
      description: Make an installment payment on a booked property. Updates booking
        deposit, project sales, and agent sales tracker.
      summary: Pay Installment
      tags:
      - dashboard
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PayInstallmentRequest'
            examples:
              PayInstallmentExample:
                value:
                  booking_id: 1
                  agent_name: John Doe
                  amount: 10000
                summary: Pay Installment Example
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PayInstallmentRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PayInstallmentRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  booking:
                    type: object
                  project_sales:
                    type: object
                  agent_sales:
                    type: object
                  previous_deposit:
                    type: number
                  new_deposit:
                    type: number
                  balance:
                    type: number
              examples:
                PayInstallmentExample:
                  value:
                    booking_id: 1
                    agent_name: John Doe
                    amount: 10000
                  summary: Pay Installment Example
          description: ''
  /dashboard/projects/:
    get:
      operationId: dashboard_projects_retrieve
      description: Get all projects with plot statistics for dashboard
      summary: Dashboard Projects
      tags:
      - dashboard
      security:
      - jwtAuth: []
      responses:
        '200':
          description: No response body
  /dashboard/recent-activity/:
    get:
      operationId: dashboard_recent_activity_retrieve
      description: Get recent bookings and projects activity for dashboard
      summary: Dashboard Recent Activity
      tags:
      - dashboard
      security:
      - jwtAuth: []
      responses:
        '200':
          description: No response body
  /dashboard/stats/:
    get:
      operationId: dashboard_stats_retrieve
      description: Get dashboard statistics including total projects, plots, bookings
        and revenue
      summary: Dashboard Statistics
      tags:
      - dashboard
      security:
      - jwtAuth: []
      responses:
        '200':
          description: No response body
  /finance/agent-sales/:
    get:
      operationId: finance_agent_sales_list
      description: Get all agent sales records for the authenticated user's projects
        with plot, commission, and agent details
      summary: List User's Agent Sales
      tags:
      - finance
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AgentSales'
          description: ''
    post:
      operationId: finance_agent_sales_create
      description: Create a new agent sales record. The plot must belong to one of
        the user's projects.
      summary: Create Agent Sale
      tags:
      - finance
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AgentSalesRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/AgentSalesRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/AgentSalesRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentSales'
          description: ''
  /finance/agent-sales/{sale_id}/:
    get:
      operationId: finance_agent_sales_retrieve
      description: Get a single agent sales record by ID. The record must belong to
        one of the user's projects.
      summary: Get Agent Sale
      parameters:
      - in: path
        name: sale_id
        schema:
          type: integer
        required: true
      tags:
      - finance
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentSales'
          description: ''
    put:
      operationId: finance_agent_sales_update
      description: Update an agent sales record. Only sub_agent_name, principal_agent,
        and commission can be updated.
      summary: Update Agent Sale (Full)
      parameters:
      - in: path
        name: sale_id
        schema:
          type: integer
        required: true
      tags:
      - finance
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AgentSalesUpdateRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/AgentSalesUpdateRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/AgentSalesUpdateRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentSales'
          description: ''
    patch:
      operationId: finance_agent_sales_partial_update
      description: Partially update an agent sales record. Only sub_agent_name, principal_agent,
        and commission can be updated.
      summary: Update Agent Sale (Partial)
      parameters:
      - in: path
        name: sale_id
        schema:
          type: integer
        required: true
      tags:
      - finance
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAgentSalesUpdateRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedAgentSalesUpdateRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedAgentSalesUpdateRequest'
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentSales'
          description: ''
    delete:
      operationId: finance_agent_sales_destroy
      description: Delete an agent sales record. The record must belong to one of
        the user's projects.
      summary: Delete Agent Sale
      parameters:
      - in: path
        name: sale_id
        schema:
          type: integer
        required: true
      tags:
      - finance
      security:
      - jwtAuth: []
      responses:
        '204':
          description: No response body
  /finance/project-sales/:
    get:
      operationId: finance_project_sales_list
      description: Get all project sales records for the authenticated user's projects
        with plot and balance details
      summary: List User's Project Sales
      tags:
      - finance
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProjectSales'
          description: ''
    post:
      operationId: finance_project_sales_create
      description: Create a new project sales record. The plot must belong to one
        of the user's projects.
      summary: Create Project Sale
      tags:
      - finance
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProjectSalesRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/ProjectSalesRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ProjectSalesRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectSales'
          description: ''
  /finance/project-sales/{sale_id}/:
    get:
      operationId: finance_project_sales_retrieve
      description: Get a single project sales record by ID. The record must belong
        to one of the user's projects.
      summary: Get Project Sale
      parameters:
      - in: path
        name: sale_id
        schema:
          type: integer
        required: true
      tags:
      - finance
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectSales'
          description: ''
    put:
      operationId: finance_project_sales_update
      description: Fully update a project sales record. The record must belong to
        one of the user's projects.
      summary: Update Project Sale (Full)
      parameters:
      - in: path
        name: sale_id
        schema:
          type: integer
        required: true
      tags:
      - finance
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProjectSalesRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/ProjectSalesRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ProjectSalesRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectSales'
          description: ''
    patch:
      operationId: finance_project_sales_partial_update
      description: Partially update a project sales record. The record must belong
        to one of the user's projects.
      summary: Update Project Sale (Partial)
      parameters:
      - in: path
        name: sale_id
        schema:
          type: integer
        required: true
      tags:
      - finance
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedProjectSalesRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedProjectSalesRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedProjectSalesRequest'
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectSales'
          description: ''
    delete:
      operationId: finance_project_sales_destroy
      description: Delete a project sales record. The record must belong to one of
        the user's projects.
      summary: Delete Project Sale
      parameters:
      - in: path
        name: sale_id
        schema:
          type: integer
        required: true
      tags:
      - finance
      security:
      - jwtAuth: []
      responses:
        '204':
          description: No response body
  /land/create_booking/:
    get:
      operationId: land_create_booking_list
      description: Get all bookings for the authenticated user's projects with plot
        details including phase, balance calculation, and nested project information
      summary: List User's Bookings
      tags:
      - land
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Booking'
          description: ''
    post:
      operationId: land_create_booking_create
      description: Create a new booking. The plot must belong to one of the user's
        projects.
      summary: Create Booking
      tags:
      - land
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BookingRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/BookingRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/BookingRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Booking'
          description: ''
  /land/create_project/:
    get:
      operationId: land_create_project_list
      description: Get all projects for the authenticated user
      summary: List User Projects
      tags:
      - land
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Project'
          description: ''
    post:
      operationId: land_create_project_create
      description: Create a new project for the authenticated user
      summary: Create Project
      tags:
      - land
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProjectRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/ProjectRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ProjectRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
          description: ''
  /land/plots/:
    get:
      operationId: land_plots_list
      description: Get all plots for the authenticated user's projects
      summary: List User's Plots
      tags:
      - land
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Plots'
          description: ''
    post:
      operationId: land_plots_create
      description: Create a new plot. The project must belong to the authenticated
        user.
      summary: Create Plot
      tags:
      - land
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlotsRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PlotsRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PlotsRequest'
        required: true
      security:
      - jwtAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Plots'
          description: ''
  /land/project/{project_id}/:
    get:
      operationId: land_project_retrieve
      description: Get a single project by ID. Users can only access their own projects.
      summary: Get Project
      parameters:
      - in: path
        name: project_id
        schema:
          type: integer
        required: true
      tags:
      - land
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
          description: ''
components:
  schemas:
    AgentSales:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        plot_details:
          allOf:
          - $ref: '#/components/schemas/PlotDetail'
          readOnly: true
        sub_agent_fee:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          readOnly: true
        purchase_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        commission:
          type: string
          format: decimal
          pattern: ^-?\d{0,3}(?:\.\d{0,2})?$
          description: Commission percentage (e.g., 5.00 for 5%)
        sub_agent_name:
          type: string
          maxLength: 200
        principal_agent:
          type: string
          maxLength: 200
        created_at:
          type: string
          format: date-time
          readOnly: true
        updated_at:
          type: string
          format: date-time
          readOnly: true
        plot:
          type: integer
      required:
      - commission
      - created_at
      - id
      - plot
      - plot_details
      - principal_agent
      - purchase_price
      - sub_agent_fee
      - updated_at
    AgentSalesRequest:
      type: object
      properties:
        purchase_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        commission:
          type: string
          format: decimal
          pattern: ^-?\d{0,3}(?:\.\d{0,2})?$
          description: Commission percentage (e.g., 5.00 for 5%)
        sub_agent_name:
          type: string
          maxLength: 200
        principal_agent:
          type: string
          minLength: 1
          maxLength: 200
        plot:
          type: integer
      required:
      - commission
      - plot
      - principal_agent
      - purchase_price
    AgentSalesUpdateRequest:
      type: object
      description: |-
        Restricted serializer for updating Agent Sales.
        Only allows updating: sub_agent_name, principal_agent, and commission.
      properties:
        sub_agent_name:
          type: string
          maxLength: 200
        principal_agent:
          type: string
          minLength: 1
          maxLength: 200
        commission:
          type: string
          format: decimal
          pattern: ^-?\d{0,3}(?:\.\d{0,2})?$
          description: Commission percentage (e.g., 5.00 for 5%)
      required:
      - commission
      - principal_agent
    BlankEnum:
      enum:
      - ''
    Booking:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        balance:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          readOnly: true
        plot_details:
          allOf:
          - $ref: '#/components/schemas/PlotDetail'
          readOnly: true
        customer_name:
          type: string
          maxLength: 200
        customer_contact:
          type: string
          maxLength: 100
        booking_date:
          type: string
          format: date-time
          readOnly: true
        payment_reference:
          type: string
          maxLength: 100
        payment_method:
          $ref: '#/components/schemas/PaymentMethodEnum'
        purchase_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        amount_paid:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        status:
          $ref: '#/components/schemas/BookingStatusEnum'
        plot:
          type: integer
      required:
      - amount_paid
      - balance
      - booking_date
      - customer_contact
      - customer_name
      - id
      - payment_method
      - payment_reference
      - plot
      - plot_details
      - status
    BookingRequest:
      type: object
      properties:
        customer_name:
          type: string
          minLength: 1
          maxLength: 200
        customer_contact:
          type: string
          minLength: 1
          maxLength: 100
        payment_reference:
          type: string
          minLength: 1
          maxLength: 100
        payment_method:
          $ref: '#/components/schemas/PaymentMethodEnum'
        purchase_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        amount_paid:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        status:
          $ref: '#/components/schemas/BookingStatusEnum'
        plot:
          type: integer
      required:
      - amount_paid
      - customer_contact
      - customer_name
      - payment_method
      - payment_reference
      - plot
      - status
    BookingStatusEnum:
      enum:
      - booked
      - confirmed
      - cancelled
      type: string
      description: |-
        * `booked` - Booked
        * `confirmed` - Confirmed
        * `cancelled` - Cancelled
    ForgotPasswordRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          minLength: 1
      required:
      - email
    NullEnum:
      enum:
      - null
    PatchedAgentSalesUpdateRequest:
      type: object
      description: |-
        Restricted serializer for updating Agent Sales.
        Only allows updating: sub_agent_name, principal_agent, and commission.
      properties:
        sub_agent_name:
          type: string
          maxLength: 200
        principal_agent:
          type: string
          minLength: 1
          maxLength: 200
        commission:
          type: string
          format: decimal
          pattern: ^-?\d{0,3}(?:\.\d{0,2})?$
          description: Commission percentage (e.g., 5.00 for 5%)
    PatchedProjectSalesRequest:
      type: object
      properties:
        phase:
          type: string
          writeOnly: true
          minLength: 1
          maxLength: 100
        client:
          type: string
          minLength: 1
          maxLength: 200
        purchase_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        deposit:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        plot:
          type: integer
    PatchedSubscriptionPlanRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
        amount:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        period:
          $ref: '#/components/schemas/PeriodEnum'
        period_count:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: Number of periods (e.g., 3 months)
        is_active:
          type: boolean
        features:
          description: List of features included in this plan
    PayInstallmentRequest:
      type: object
      properties:
        booking_id:
          type: integer
        agent_name:
          type: string
          minLength: 1
          maxLength: 200
        amount:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
      required:
      - agent_name
      - amount
      - booking_id
    Payment:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        user:
          type: integer
          readOnly: true
        user_details:
          allOf:
          - $ref: '#/components/schemas/User'
          readOnly: true
        subscription:
          type: integer
        plan:
          type: integer
          nullable: true
        plan_details:
          allOf:
          - $ref: '#/components/schemas/SubscriptionPlan'
          readOnly: true
        amount:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        payment_type:
          $ref: '#/components/schemas/PaymentTypeEnum'
        status:
          allOf:
          - $ref: '#/components/schemas/PaymentStatusEnum'
          readOnly: true
        pesapal_order_tracking_id:
          type: string
          description: Pesapal OrderTrackingId
          maxLength: 200
        pesapal_merchant_reference:
          type: string
          description: Our internal reference
          maxLength: 200
        pesapal_transaction_id:
          type: string
          readOnly: true
          nullable: true
          description: Pesapal transaction ID after completion
        payment_method:
          type: string
          readOnly: true
        currency:
          type: string
          maxLength: 10
        is_recurring:
          type: boolean
          description: Whether this is a recurring payment setup
        recurring_frequency:
          nullable: true
          oneOf:
          - $ref: '#/components/schemas/RecurringFrequencyEnum'
          - $ref: '#/components/schemas/BlankEnum'
          - $ref: '#/components/schemas/NullEnum'
        metadata: {}
        created_at:
          type: string
          format: date-time
          readOnly: true
        updated_at:
          type: string
          format: date-time
          readOnly: true
      required:
      - amount
      - created_at
      - id
      - payment_method
      - pesapal_transaction_id
      - plan_details
      - status
      - subscription
      - updated_at
      - user
      - user_details
    PaymentMethodEnum:
      enum:
      - cash
      - mpesa
      - bank_transfer
      type: string
      description: |-
        * `cash` - Cash
        * `mpesa` - mpesa
        * `bank_transfer` - Bank Transfer
    PaymentStatusEnum:
      enum:
      - pending
      - successful
      - failed
      - cancelled
      type: string
      description: |-
        * `pending` - Pending
        * `successful` - Successful
        * `failed` - Failed
        * `cancelled` - Cancelled
    PaymentTypeEnum:
      enum:
      - subscription
      - renewal
      type: string
      description: |-
        * `subscription` - Subscription
        * `renewal` - Renewal
    PeriodEnum:
      enum:
      - daily
      - weekly
      - monthly
      - quarterly
      - yearly
      type: string
      description: |-
        * `daily` - Daily
        * `weekly` - Weekly
        * `monthly` - Monthly
        * `quarterly` - Quarterly
        * `yearly` - Yearly
    PlotDetail:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        project:
          allOf:
          - $ref: '#/components/schemas/Project'
          readOnly: true
        plot_number:
          type: string
          maxLength: 50
        phase:
          type: string
          description: Phase information from the booking
          readOnly: true
        size:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        property_type:
          $ref: '#/components/schemas/PropertyTypeEnum'
        is_available:
          type: boolean
        created_at:
          type: string
          format: date-time
          readOnly: true
        updated_at:
          type: string
          format: date-time
          readOnly: true
      required:
      - created_at
      - id
      - phase
      - plot_number
      - price
      - project
      - size
      - updated_at
    Plots:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        phase:
          type: string
        plot_number:
          type: string
          maxLength: 50
        size:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        property_type:
          $ref: '#/components/schemas/PropertyTypeEnum'
        is_available:
          type: boolean
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
        updated_at:
          type: string
          format: date-time
          readOnly: true
        project:
          type: integer
      required:
      - created_at
      - id
      - is_available
      - plot_number
      - price
      - project
      - size
      - updated_at
    PlotsRequest:
      type: object
      properties:
        phase:
          type: string
        plot_number:
          type: string
          minLength: 1
          maxLength: 50
        size:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        property_type:
          $ref: '#/components/schemas/PropertyTypeEnum'
        project:
          type: integer
      required:
      - plot_number
      - price
      - project
      - size
    Project:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        name:
          type: string
          maxLength: 200
        phase:
          type: array
          items:
            type: string
            maxLength: 100
        project_svg_map:
          type: string
          format: uri
          nullable: true
        location:
          type: string
          maxLength: 300
        size:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        created_at:
          type: string
          format: date-time
          readOnly: true
        updated_at:
          type: string
          format: date-time
          readOnly: true
        user:
          type: integer
          readOnly: true
          nullable: true
      required:
      - created_at
      - id
      - location
      - name
      - size
      - updated_at
      - user
    ProjectRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 200
        phase:
          type: array
          items:
            type: string
            minLength: 1
            maxLength: 100
        project_svg_map:
          type: string
          format: binary
          nullable: true
        location:
          type: string
          minLength: 1
          maxLength: 300
        size:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
      required:
      - location
      - name
      - size
    ProjectSales:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        balance:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          readOnly: true
        plot_details:
          allOf:
          - $ref: '#/components/schemas/PlotDetail'
          readOnly: true
        client:
          type: string
          maxLength: 200
        purchase_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        deposit:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        created_at:
          type: string
          format: date-time
          readOnly: true
        updated_at:
          type: string
          format: date-time
          readOnly: true
        plot:
          type: integer
      required:
      - balance
      - client
      - created_at
      - deposit
      - id
      - plot
      - plot_details
      - purchase_price
      - updated_at
    ProjectSalesRequest:
      type: object
      properties:
        phase:
          type: string
          writeOnly: true
          minLength: 1
          maxLength: 100
        client:
          type: string
          minLength: 1
          maxLength: 200
        purchase_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        deposit:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        plot:
          type: integer
      required:
      - client
      - deposit
      - phase
      - plot
      - purchase_price
    PropertyTypeEnum:
      enum:
      - commercial
      - residential
      type: string
      description: |-
        * `commercial` - Commercial
        * `residential` - Residential
    RecurringFrequencyEnum:
      enum:
      - DAILY
      - WEEKLY
      - MONTHLY
      - YEARLY
      type: string
      description: |-
        * `DAILY` - Daily
        * `WEEKLY` - Weekly
        * `MONTHLY` - Monthly
        * `YEARLY` - Yearly
    ResetPasswordRequest:
      type: object
      properties:
        token:
          type: string
          format: uuid
        password:
          type: string
          writeOnly: true
          minLength: 8
        password_confirm:
          type: string
          writeOnly: true
          minLength: 1
      required:
      - password
      - password_confirm
      - token
    SubscribeRequest:
      type: object
      properties:
        plan_id:
          type: integer
      required:
      - plan_id
    SubscriptionPlan:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        name:
          type: string
          maxLength: 200
        description:
          type: string
        amount:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        period:
          $ref: '#/components/schemas/PeriodEnum'
        period_count:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: Number of periods (e.g., 3 months)
        is_active:
          type: boolean
        features:
          description: List of features included in this plan
        duration_in_days:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
        updated_at:
          type: string
          format: date-time
          readOnly: true
      required:
      - amount
      - created_at
      - duration_in_days
      - id
      - name
      - updated_at
    SubscriptionPlanRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
        amount:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        period:
          $ref: '#/components/schemas/PeriodEnum'
        period_count:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: Number of periods (e.g., 3 months)
        is_active:
          type: boolean
        features:
          description: List of features included in this plan
      required:
      - amount
      - name
    TokenRefresh:
      type: object
      properties:
        access:
          type: string
          readOnly: true
        refresh:
          type: string
      required:
      - access
      - refresh
    TokenRefreshRequest:
      type: object
      properties:
        refresh:
          type: string
          minLength: 1
      required:
      - refresh
    User:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        username:
          type: string
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        first_name:
          type: string
          maxLength: 150
        last_name:
          type: string
          maxLength: 150
        is_active:
          type: boolean
          title: Active
          description: Designates whether this user should be treated as active. Unselect
            this instead of deleting accounts.
        date_joined:
          type: string
          format: date-time
          readOnly: true
        role:
          type: string
          readOnly: true
      required:
      - date_joined
      - id
      - role
      - username
    UserLoginRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          minLength: 1
        password:
          type: string
          minLength: 1
      required:
      - email
      - password
    UserRegistrationRequest:
      type: object
      properties:
        username:
          type: string
          minLength: 1
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        first_name:
          type: string
          maxLength: 150
        last_name:
          type: string
          maxLength: 150
        password:
          type: string
          writeOnly: true
          minLength: 8
        password_confirm:
          type: string
          writeOnly: true
          minLength: 1
      required:
      - password
      - password_confirm
      - username
    UserSubscription:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        user:
          type: integer
          readOnly: true
        user_details:
          allOf:
          - $ref: '#/components/schemas/User'
          readOnly: true
        plan:
          type: integer
          nullable: true
        plan_details:
          allOf:
          - $ref: '#/components/schemas/SubscriptionPlan'
          readOnly: true
        status:
          allOf:
          - $ref: '#/components/schemas/UserSubscriptionStatusEnum'
          readOnly: true
        start_date:
          type: string
          format: date-time
          readOnly: true
          nullable: true
        end_date:
          type: string
          format: date-time
          readOnly: true
          nullable: true
        auto_renew:
          type: boolean
        recurring_payment_active:
          type: boolean
          readOnly: true
          description: Whether user has active recurring payment configured at Pesapal
        last_recurring_payment_date:
          type: string
          format: date-time
          readOnly: true
          nullable: true
        is_currently_active:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
        updated_at:
          type: string
          format: date-time
          readOnly: true
      required:
      - created_at
      - end_date
      - id
      - is_currently_active
      - last_recurring_payment_date
      - plan_details
      - recurring_payment_active
      - start_date
      - status
      - updated_at
      - user
      - user_details
    UserSubscriptionStatusEnum:
      enum:
      - pending
      - active
      - expired
      - cancelled
      type: string
      description: |-
        * `pending` - Pending
        * `active` - Active
        * `expired` - Expired
        * `cancelled` - Cancelled
  securitySchemes:
    jwtAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
